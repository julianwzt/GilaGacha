:root {
    --p1-color: #00ffff;
    --p2-color: #ff0055;
    --bg-color: #050510; 
    --slot-width: min(320px, 40vmin);
    --slot-height: min(420px, 52.5vmin);
    --drum-radius: min(130px, 16.25vmin); 
    --panel-height: min(60px, 7.5vmin);
    --panel-width: min(200px, 25vmin);
    --drum-container-width: min(220px, 27.5vmin);
    --clash-box-size: min(180px, 22.5vmin);
    --font-xs: min(1rem, 2vmin);
    --font-sm: min(1.4rem, 2.8vmin);
    --font-md: min(2.5rem, 4.5vmin);
    --font-lg: min(3.5rem, 6vmin);
    --font-xl: min(5rem, 8vmin);
    --font-xxl: min(6.5rem, 10vmin);
}

* { box-sizing: border-box; }

body {
    margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: radial-gradient(circle at center, #1a1a2e 0%, #0a0a12 60%, #050510 100%);
    color: white; overflow: hidden; width: 100vw; height: 100vh;
    display: flex; justify-content: center; align-items: center;
}

body.shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
@keyframes shake {
    10%, 90% { transform: translate3d(-5px, 0, 0); }
    20%, 80% { transform: translate3d(5px, 0, 0); }
    30%, 50%, 70% { transform: translate3d(-10px, 0, 0); }
    40%, 60% { transform: translate3d(10px, 0, 0); }
}

#game-container { width: 100vw; height: 100vh; display: flex; flex-direction: column; justify-content: space-between; position: relative; }

/* HUD ATAS */
.hud-top { width: 100%; display: flex; justify-content: space-between; align-items: flex-start; padding: min(20px, 3vh) min(50px, 5vw) 0; height: 15vh; }
.player-stats { width: 35%; text-align: center; display: flex; flex-direction: column; align-items: center; z-index: 106;}
.p1-text { color: var(--p1-color); text-shadow: 0 0 15px var(--p1-color), 0 0 30px var(--p1-color); font-weight: bold; transition: color 0.3s, text-shadow 0.3s; }
.p2-text { color: var(--p2-color); text-shadow: 0 0 15px var(--p2-color), 0 0 30px var(--p2-color); font-weight: bold; transition: color 0.3s, text-shadow 0.3s;}

.name-crown-wrapper { display: flex; align-items: center; justify-content: center; gap: 10px; margin: min(5px, 1vmin) 0; min-height: min(30px, 5vmin); }
.player-stats h2 { margin: 0; font-size: var(--font-sm); text-transform: uppercase; letter-spacing: 2px; }

.hp-bar-frame { width: 100%; height: min(25px, 3vmin); background: #222; border: 2px solid #444; border-radius: min(15px, 2vmin); overflow: hidden; position: relative; }
.hp-fill { height: 100%; transition: width 0.5s ease, background 0.3s; }
#p1-hp { width: 100%; background: var(--p1-color); float: left; box-shadow: inset -10px 0 10px rgba(0,0,0,0.5); }
#p2-hp { width: 100%; background: var(--p2-color); float: right; box-shadow: inset 10px 0 10px rgba(0,0,0,0.5); }

.timer-box { width: min(150px, 20vmin); text-align: center; font-size: var(--font-xs); font-weight: bold; border: min(3px, 0.5vmin) solid #fff; border-top: none; border-radius: 0 0 min(20px, 3vmin) min(20px, 3vmin); padding: min(10px, 1.5vmin); background: #111; box-shadow: 0 10px 30px rgba(0,0,0,0.7); z-index: 106;}
#timer-text { font-size: var(--font-md); color: #fff; line-height: 1.2; }
.timer-warning { color: #ff3300 !important; animation: blink 1s infinite; }
@keyframes blink { 50% { opacity: 0.5; } }

/* ARENA & SLOT */
.main-arena { width: 100%; height: 65vh; display: flex; justify-content: space-between; align-items: center; padding: 0 5vw; perspective: 1200px; position: relative; }
.slot-machine { width: var(--slot-width); height: var(--slot-height); position: relative; display: flex; justify-content: center; align-items: center; }
.slot-housing { position: absolute; width: 100%; height: 100%; background: transparent; border: min(4px, 0.5vmin) solid #333; z-index: 10; pointer-events: none; box-shadow: inset 0 0 min(50px, 6vmin) rgba(0,0,0,0.9); }
#p1-machine .slot-housing { border-radius: 0 min(160px, 20vmin) min(160px, 20vmin) 0; border-left: none; }
#p2-machine .slot-housing { border-radius: min(160px, 20vmin) 0 0 min(160px, 20vmin); border-right: none; }

.phase-indicator-group { position: absolute; top: 50%; transform: translateY(-50%); display: flex; flex-direction: column; gap: min(60px, 7.5vmin); z-index: 15; }
#p1-machine .phase-indicator-group { right: min(-50px, -6.25vmin); align-items: flex-start; }
#p2-machine .phase-indicator-group { left: min(-50px, -6.25vmin); align-items: flex-end; }
.phase-label { font-size: var(--font-xs); font-weight: bold; writing-mode: vertical-rl; text-transform: uppercase; transition: all 0.3s; }
#p2-machine .phase-label { transform: rotate(180deg); }

.phase-label.p1-phase.active-phase { color: var(--p1-color); text-shadow: 0 0 15px var(--p1-color); opacity: 1; }
.phase-label.p2-phase.active-phase { color: var(--p2-color); text-shadow: 0 0 15px var(--p2-color); opacity: 1; }
.phase-label.inactive-phase { color: #444; text-shadow: none; opacity: 0.4; }

.pointer-arrow { position: absolute; top: 50%; width: 0; height: 0; border-style: solid; z-index: 20; transform: translateY(-50%); transition: border-color 0.3s, filter 0.3s; }
#p1-pointer { left: min(70px, 8.75vmin); border-width: min(20px, 2.5vmin) 0 min(20px, 2.5vmin) min(30px, 3.75vmin); border-color: transparent transparent transparent var(--p1-color); filter: drop-shadow(0 0 10px var(--p1-color)); }
#p2-pointer { right: min(70px, 8.75vmin); border-width: min(20px, 2.5vmin) min(30px, 3.75vmin) min(20px, 2.5vmin) 0; border-color: transparent var(--p2-color) transparent transparent; filter: drop-shadow(0 0 10px var(--p2-color)); }

.drum-container { width: var(--drum-container-width); height: var(--panel-height); position: relative; transform-style: preserve-3d; }
#p1-machine .drum-container { transform: rotateY(15deg); }
#p2-machine .drum-container { transform: rotateY(-15deg); }
.drum { width: 100%; height: 100%; position: absolute; transform-style: preserve-3d; transition: transform 1.2s cubic-bezier(0.2, 0.8, 0.2, 1); }
.panel { position: absolute; width: var(--panel-width); height: var(--panel-height); left: min(10px, 1.2vmin); background: rgba(20, 20, 25, 0.95); border: 2px solid #555; border-radius: min(10px, 1.2vmin); display: flex; justify-content: center; align-items: center; font-size: var(--font-md); font-weight: bold; box-shadow: 0 0 20px rgba(0,0,0,0.8); transform: rotateX(var(--rx)) translateZ(var(--drum-radius)); backface-visibility: hidden; color: white !important; }
.panel.extra-mode { background: #112211; border-color: #337733; color: #00ff66 !important; }

.live-calc-display { position: absolute; bottom: min(-60px, -8vmin); width: 100%; text-align: center; font-size: var(--font-sm); font-weight: bold; z-index: 25; }
.calc-total-val { font-size: var(--font-md); color: #fff; text-shadow: 0 0 15px #fff; display: inline-block; transform: scale(0); transition: transform 0.4s; }
.calc-total-val.show { transform: scale(1); }
.control-area { position: absolute; bottom: min(-140px, -18vmin); width: 100%; display: flex; flex-direction: column; align-items: center; z-index: 30; }
.action-btn { background: rgba(10, 10, 15, 0.9); padding: min(12px, 1.5vmin) min(35px, 4.5vmin); font-size: var(--font-sm); font-weight: bold; border-radius: min(10px, 1.2vmin); cursor: pointer; text-transform: uppercase; transition: all 0.3s ease; }

.p1-btn-style { border: 3px solid var(--p1-color); color: var(--p1-color); box-shadow: 0 0 15px rgba(0,0,0,0.4); }
.p1-btn-style:active:not(:disabled) { background: var(--p1-color); color: black; box-shadow: 0 0 30px var(--p1-color); }
.p2-btn-style { border: 3px solid var(--p2-color); color: var(--p2-color); box-shadow: 0 0 15px rgba(0,0,0,0.4); }
.p2-btn-style:active:not(:disabled) { background: var(--p2-color); color: black; box-shadow: 0 0 30px var(--p2-color); }
.key-hint { font-size: var(--font-xs); opacity: 0.7; margin-top: 5px; transition: color 0.3s;}

/* HUD BAWAH */
.hud-bottom { width: 100%; height: 20vh; display: flex; justify-content: center; align-items: center; border-top: 2px solid #333; background: rgba(0,0,0,0.3); }
.static-vs { font-size: var(--font-xl); font-weight: bold; color: #555; font-style: italic; letter-spacing: 5px; }

/* ANIMASI CLASH */
#animation-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; pointer-events: none; display: flex; justify-content: center; align-items: center; opacity: 0; transition: opacity 0.3s; background: rgba(10,10,15,0.9); }
#animation-layer.active { opacity: 1; pointer-events: all; }
.clash-item { position: absolute; width: var(--clash-box-size); height: var(--clash-box-size); display: flex; justify-content: center; align-items: center; font-size: var(--font-md); font-weight: bold; background: #111; border: 5px solid currentColor; border-radius: 20px; box-shadow: 0 0 40px currentColor; transition: transform 0.5s, opacity 0.2s, border-color 0.3s, color 0.3s; }
#p1-anim-val { left: 15vw; color: var(--p1-color); }
#p2-anim-val { right: 15vw; color: var(--p2-color); }
.anim-vs { position: absolute; font-size: var(--font-lg); color: #fff; font-style: italic; opacity: 0; transition: opacity 0.3s; }
.anim-vs.show { opacity: 1; }
.fly-clash-p1 { transform: translateX(35vw) scale(1.2) !important; }
.fly-clash-p2 { transform: translateX(-35vw) scale(1.2) !important; }
#clash-result-text { position: absolute; font-size: var(--font-lg); font-weight: bold; text-transform: uppercase; text-align: center; text-shadow: 0 0 30px currentColor; opacity: 0; transform: scale(0.5); transition: all 0.3s; z-index: 110; line-height: 1.2;}
#clash-result-text.show { opacity: 1; transform: scale(1); }

/* MENU SYSTEM */
.menu-overlay { position: absolute; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(5, 5, 16, 0.95); z-index: 200; display: none; flex-direction: column; justify-content: center; align-items: center; }
.menu-overlay.active { display: flex; }
.game-title { font-size: var(--font-xxl); font-weight: bold; text-transform: uppercase; margin-bottom: 50px; text-align: center; background: linear-gradient(90deg, var(--p1-color), var(--p2-color)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; transition: background 0.5s;}
.neon-btn { background: transparent; border: 3px solid #fff; color: #fff; padding: 15px 40px; font-size: var(--font-sm); font-weight: bold; text-transform: uppercase; cursor: pointer; border-radius: 10px; margin: 10px; transition: 0.3s; }
.neon-btn:hover { background: #fff; color: #000; }
.input-group { display: flex; flex-direction: column; gap: 20px; align-items: center; }
.custom-input { background: rgba(0,0,0,0.5); border: 2px solid #555; color: white; width: min(300px, 80vw); padding: 15px; font-size: var(--font-sm); text-align: center; border-radius: 10px; outline: none; transition: 0.3s;}
#input-p1:focus { border-color: var(--p1-color); box-shadow: 0 0 15px var(--p1-color); }
#input-p2:focus { border-color: var(--p2-color); box-shadow: 0 0 15px var(--p2-color); }
#champion-display { font-size: var(--font-lg); text-align: center; text-transform: uppercase; margin-bottom: 20px; transition: color 0.5s; white-space: pre-wrap; }

/* HOVER "HAHA KASIAN" */
.tooltip-btn { position: relative; }
.tooltip-btn:hover::after {
    content: "haha kasian"; position: absolute; top: -35px; left: 50%; transform: translateX(-50%);
    background: #ff0055; color: white; padding: 5px 15px; border-radius: 5px; font-size: 14px; white-space: nowrap; pointer-events: none;
    box-shadow: 0 0 10px #ff0055; animation: popUp 0.3s forwards;
}
@keyframes popUp { 0% { opacity: 0; transform: translate(-50%, 10px) scale(0.5); } 100% { opacity: 1; transform: translate(-50%, 0) scale(1); } }

/* COLOR PICKER PALETTE */
.player-setup { display: flex; flex-direction: column; align-items: center; width: 100%; margin-bottom: 10px;}
.color-palette { display: flex; gap: min(10px, 2vmin); margin-top: 10px; justify-content: center; }
.color-swatch { width: min(30px, 6vmin); height: min(30px, 6vmin); border-radius: 50%; background-color: var(--swatch-color); cursor: pointer; border: 2px solid transparent; box-shadow: 0 0 10px var(--swatch-color); transition: all 0.2s; }
.color-swatch:hover { transform: scale(1.2); }
.color-swatch.selected { border-color: white; transform: scale(1.2); box-shadow: 0 0 20px var(--swatch-color), inset 0 0 5px rgba(0,0,0,0.7); }

/* SISTEM MAHKOTA */
#victory-crown { width: min(100px, 15vmin); height: auto; margin-bottom: min(10px, 2vmin); filter: drop-shadow(0 0 20px gold); opacity: 0; transform: scale(0.5) translateY(50px); transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
#victory-crown.show-crown { opacity: 1; transform: scale(1) translateY(0); }
.crown-container { display: flex; align-items: center; gap: min(5px, 1vmin); }
.small-crown { width: min(25px, 4vmin); height: auto; filter: drop-shadow(0 0 5px gold); animation: crownPop 0.5s ease-out backwards; }
@keyframes crownPop { 0% { transform: scale(0); opacity: 0; } 80% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); } }


/* ========================================= */
/* EFEK DOUBLE JACKPOT (INSTANT K.O)         */
/* ========================================= */
body.mega-shake { animation: megaShake 0.5s cubic-bezier(.36,.07,.19,.97) both infinite; }
@keyframes megaShake {
    0%, 100% { transform: translate3d(0, 0, 0); }
    10%, 30%, 50%, 70%, 90% { transform: translate3d(-20px, 20px, 0) rotate(-3deg); }
    20%, 40%, 60%, 80% { transform: translate3d(20px, -20px, 0) rotate(3deg); }
}

.dark-flash {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: black; z-index: 105; opacity: 0; pointer-events: none;
    transition: opacity 0.3s;
}
.dark-flash.active { opacity: 0.9; }

#clash-result-text.mega-jackpot {
    font-size: min(4.5rem, 7vw);
    color: #fff;
    text-shadow: 0 0 30px #ff0000, 0 0 60px #ff0000, 0 0 100px #ffff00;
    animation: pulseMega 0.3s infinite alternate;
    white-space: pre-wrap; 
    z-index: 120;
}
@keyframes pulseMega {
    from { transform: scale(1); }
    to { transform: scale(1.15); }
}
